<!DOCTYPE html>
<html lang="{{ page.lang | default: site.lang }}">
  {% include head.html %}
  <body class="layout-personal-home">
    {% include header.html %}
    {%- if page.hero -%}
      {% include hero.html title=page.hero.title subtitle=page.hero.subtitle eyebrow=page.hero.eyebrow cta=page.hero.cta secondary_cta=page.hero.secondary_cta media=page.hero.media %}
    {%- else -%}
      {% include hero.html title=page.title subtitle=page.subtitle %}
    {%- endif -%}
    <main class="site-main">
      <section class="site-main-section container">
        <div class="search-box surface-card">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197M15.803 15.803A7.5 7.5 0 1 0 5 5a7.5 7.5 0 0 0 10.803 10.803Z" />
          </svg>
          <label class="sr-only" for="site-search">Search the knowledge base</label>
          <input id="site-search" type="search" class="input" placeholder="Search insights, models, and case studies" data-search-input>
        </div>
        <div class="search-results" data-search-results></div>
      </section>

      <section class="site-main-section container">
        <div class="flex align-center justify-between wrap gap-1 mb-2">
          <h2>Latest publications</h2>
          <a class="btn btn-ghost" href="{{ '/archive' | relative_url }}">View all</a>
        </div>
        <div class="card-grid auto-fit">
          {%- assign recent_posts = page.featured_posts | default: site.posts | sort: 'date' | reverse -%}
          {%- for post in recent_posts limit:6 -%}
            {% include post-card.html post=post %}
          {%- endfor -%}
        </div>
      </section>

      {%- if page.tabs -%}
      <section class="site-main-section container surface-card">
        {% include tabs.html tabs=page.tabs %}
      </section>
      {%- endif -%}

      {%- if page.timeline -%}
      <section class="site-main-section container">
        <h2>Trajectory</h2>
        {% include timeline.html events=page.timeline %}
      </section>
      {%- endif -%}

      {%- if page.callouts -%}
      <section class="site-main-section container dark-card-grid">
        {%- for callout in page.callouts -%}
          <article class="dark-card">
            <h3>{{ callout.title }}</h3>
            <div class="stack gap-1 text-muted">
              {{ callout.body | markdownify }}
            </div>
            {%- if callout.link -%}
              <a class="btn btn-ghost" href="{{ callout.link.url }}">{{ callout.link.label | default: 'Learn more' }}</a>
            {%- endif -%}
          </article>
        {%- endfor -%}
      </section>
      {%- endif -%}
    </main>
    {% include footer.html %}
    <script defer src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script>
    <script defer src="{{ '/assets/js/search.js' | relative_url }}"></script>
    {%- if page.tabs -%}
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        const tabs = document.querySelectorAll('.tab-btn');
        const panels = document.querySelectorAll('.tab-panel');
        tabs.forEach((tab) => {
          tab.addEventListener('click', () => {
            const target = tab.getAttribute('data-tab-target');
            tabs.forEach((btn) => {
              const isActive = btn === tab;
              btn.classList.toggle('is-active', isActive);
              btn.setAttribute('aria-selected', isActive ? 'true' : 'false');
              btn.setAttribute('tabindex', isActive ? '0' : '-1');
            });
            panels.forEach((panel) => {
              const show = panel.id === target;
              panel.classList.toggle('is-active', show);
            });
          });
        });
      });
    </script>
    {%- endif -%}
  </body>
</html>
