---
layout: default
---

{% assign tabs = page.tabs %}

{%- if page.hero -%}
  {% include hero.html
     title=page.hero.title
     subtitle=page.hero.subtitle
     eyebrow=page.hero.eyebrow
     cta=page.hero.cta
     secondary_cta=page.hero.secondary_cta
     media=page.hero.media %}
{%- endif -%}

<main class="site-main">
  <section class="site-main-section container">
    <header class="stack gap-1">
      <h1 class="page-title">{{ page.title | escape }}</h1>
      {%- if page.subtitle -%}<p class="text-muted page-subtitle">{{ page.subtitle }}</p>{%- endif -%}
      {%- if page.lede -%}<p class="text-muted page-lede">{{ page.lede }}</p>{%- endif -%}
    </header>

    {%- if page.filters -%}
      <div class="tag-cloud mt-2">
        {%- for filter in page.filters -%}
          {% include chip.html label=filter.label variant=filter.variant %}
        {%- endfor -%}
      </div>
    {%- endif -%}
  </section>

  {%- comment -%}
  优先渲染 Tabs（codex）；若无 tabs，则回退到 projects（main）
  {%- endcomment -%}
  {% if tabs and tabs != empty %}
    <section class="site-main-section container">
      <div class="portfolio-tabs" role="tablist" aria-label="Portfolio focus areas">
        {% for tab in tabs %}
          <input type="radio" name="portfolio-tab" id="tab-{{ tab.id }}" {% if forloop.first %}checked{% endif %}>
          <label for="tab-{{ tab.id }}" role="tab" aria-controls="panel-{{ tab.id }}">{{ tab.label }}</label>
        {% endfor %}

        {% for tab in tabs %}
          <section id="panel-{{ tab.id }}" class="tab-panel" role="tabpanel" aria-labelledby="tab-{{ tab.id }}">
            {% if tab.intro %}<p class="tab-intro">{{ tab.intro }}</p>{% endif %}

            {% if tab.blocks and tab.blocks.size > 0 %}
              <div class="tab-grid">
                {% for block in tab.blocks %}
                  <article class="portfolio-card surface-card stack gap-1">
                    <header class="stack gap-0-5">
                      <h3>{{ block.title }}</h3>
                      {% if block.role or block.timeframe %}
                        <p class="portfolio-meta">
                          {% if block.role %}<span class="portfolio-role">{{ block.role }}</span>{% endif %}
                          {% if block.timeframe %}<span class="portfolio-timeframe">{{ block.timeframe }}</span>{% endif %}
                        </p>
                      {% endif %}
                    </header>

                    {% if block.summary %}<p class="portfolio-summary">{{ block.summary }}</p>{% endif %}

                    {% if block.highlights and block.highlights.size > 0 %}
                      <ul class="portfolio-highlights">
                        {% for item in block.highlights %}
                          <li>{{ item }}</li>
                        {% endfor %}
                      </ul>
                    {% endif %}

                    {% if block.stack and block.stack.size > 0 %}
                      <p class="portfolio-stack"><strong>Stack:</strong> {{ block.stack | join: ', ' }}</p>
                    {% endif %}

                    {% if block.links and block.links.size > 0 %}
                      <p class="portfolio-links">
                        {% for link in block.links %}
                          <a href="{{ link.url }}" class="portfolio-cta">{{ link.label }}</a>
                        {% endfor %}
                      </p>
                    {% endif %}
                  </article>
                {% endfor %}
              </div>
            {% else %}
              <p class="empty-state text-muted">Content coming soon.</p>
            {% endif %}
          </section>
        {% endfor %}
      </div>
    </section>
  {% elsif page.projects %}
    <section class="site-main-section container card-grid auto-fit">
      {%- for project in page.projects -%}
        <article class="surface-card stack gap-1">
          <h3>{{ project.title }}</h3>
          <div class="text-muted stack gap-1">
            {{ project.description | markdownify }}
          </div>

          {%- if project.metrics -%}
            <ul class="stack gap-1 text-sm">
              {%- for metric in project.metrics -%}
                <li><strong>{{ metric.label }}:</strong> {{ metric.value }}</li>
              {%- endfor -%}
            </ul>
          {%- endif -%}

          {%- if project.tags -%}
            <div class="flex gap-1 wrap">
              {%- for tag in project.tags -%}
                {% include chip.html label=tag %}
              {%- endfor -%}
            </div>
          {%- endif -%}

          {%- if project.link -%}
            <a class="btn btn-ghost" href="{{ project.link.url }}">{{ project.link.label | default: 'View case study' }}</a>
          {%- endif -%}
        </article>
      {%- endfor -%}
    </section>
  {% else %}
    <section class="site-main-section container">
      <p class="empty-state text-muted">This portfolio is still under construction.</p>
    </section>
  {% endif %}

  {%- if page.map -%}
    <section class="site-main-section container">
      <h2>{{ page.map.title | default: 'Global presence' }}</h2>
      <div class="surface-card" style="height: 26rem; overflow: hidden;">
        <div
          data-map
          data-lat="{{ page.map.lat }}"
          data-lng="{{ page.map.lng }}"
          data-zoom="{{ page.map.zoom | default: 2 }}"
          data-marker="{{ page.map.marker | escape }}"
          style="height: 100%;"></div>
      </div>
    </section>
  {%- endif -%}
</main>

{%- if page.map -%}
  <script defer src="{{ '/assets/js/map.js' | relative_url }}"></script>
{%- endif -%}

<style>
/* --- Tabs UI (codex) --- */
.portfolio-tabs { display: grid; gap: 1rem; }
.portfolio-tabs input[type="radio"] { display: none; }
.portfolio-tabs label {
  display: inline-flex; align-items: center; justify-content: center;
  padding: .75rem 1.25rem; border-radius: 999px;
  border: 1px solid var(--border-color, #d0d7de);
  background: var(--chip-bg, rgba(15,23,42,.04));
  font-weight: 600; cursor: pointer; transition: all .2s ease;
}
.portfolio-tabs label:hover, .portfolio-tabs label:focus {
  border-color: #6366f1; color: #4338ca;
}
.tab-panel {
  display: none; padding: 1.5rem; border-radius: 1rem;
  border: 1px solid var(--border-color, #e5e7eb);
  background: var(--panel-bg, rgba(255,255,255,.7));
  box-shadow: 0 16px 40px rgba(15,23,42,.08);
}
.tab-intro { font-size: 1rem; color: var(--text-color-secondary, #555); margin-bottom: 1rem; }
.tab-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 1.5rem; }

/* --- Cards --- */
.portfolio-card {
  border: 1px solid var(--border-color, #e0e0e0);
  border-radius: .75rem; padding: 1.25rem;
  background: var(--card-bg, rgba(248,250,252,.8));
  display: flex; flex-direction: column; gap: .75rem;
}
.portfolio-meta { display: flex; flex-wrap: wrap; gap: .5rem; font-size: .9rem; color: var(--text-color-secondary, #555); }
.portfolio-summary { margin: 0; }
.portfolio-highlights { margin: 0; padding-left: 1.25rem; }
.portfolio-stack { font-size: .9rem; color: var(--text-color-secondary, #555); }
.portfolio-links { margin-top: auto; display: flex; flex-wrap: wrap; gap: .75rem; }
.portfolio-cta {
  display: inline-flex; padding: .5rem 1rem; border-radius: 999px;
  border: 1px solid #4f46e5; color: #4f46e5; text-decoration: none; font-weight: 600;
  transition: background .2s ease, color .2s ease;
}
.portfolio-cta:hover, .portfolio-cta:focus { background: #4f46e5; color: #fff; }
.empty-state { font-style: italic; color: var(--text-color-secondary, #777); }

/* --- Checked state for each tab (generated) --- */
{% if tabs and tabs != empty %}
{% for tab in tabs %}
#tab-{{ tab.id }}:checked ~ label[for="tab-{{ tab.id }}"] {
  background: linear-gradient(135deg, #6366f1, #8b5cf6);
  color: #fff; border-color: transparent;
  box-shadow: 0 12px 24px rgba(99,102,241,.3);
}
#tab-{{ tab.id }}:checked ~ #panel-{{ tab.id }} { display: block; }
{% endfor %}
{% endif %}

@media (max-width: 768px) { .tab-panel { padding: 1rem; } }
</style>

